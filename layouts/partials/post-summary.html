{{- $title := .Title -}}
{{- if not $title }}
  {{- $title = (.Summary | plainify | truncate 80) -}}
{{- end -}}
{{- $showTitle := and $title (not .Params.microblog) -}}

{{- $featuredImage := "" -}}
{{- with .Params.featured_image }}
  {{- $featuredImage = . -}}
{{- else }}
  {{- with .Params.image }}
    {{- $featuredImage = . -}}
  {{- else }}
    {{- with .Params.images }}
      {{- if gt (len .) 0 }}
        {{- $featuredImage = index . 0 -}}
      {{- end }}
    {{- end }}
  {{- end }}
{{- end -}}

<article class="post-summary">
  {{ if $featuredImage }}
  <div class="post-thumbnail">
    <a href="{{ .RelPermalink }}">
      <img src="{{ $featuredImage }}" alt="{{ $title }}" loading="lazy" />
    </a>
  </div>
  {{ end }}

  {{ if $showTitle }}
  <h2><a href="{{ .RelPermalink }}">{{ $title }}</a></h2>
  {{ end }}

  <div class="post-content">
    {{ .Content }}
  </div>

  <div class="meta">
    <a class="post-date" href="{{ .RelPermalink }}">{{ .Date.Format "January 2, 2006" }}</a>
    {{ with .Params.bookmark_of }}
    <a class="bookmark-link" href="{{ . }}" rel="noopener" target="_blank">Source â†—</a>
    {{ end }}
    {{ range .Params.categories }}
      {{ partial "category-badge.html" . }}
    {{ end }}
  </div>
</article>
